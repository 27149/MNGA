syntax = "proto3";

import "DataModel.proto";

//
// sync

message SyncRequest {
  oneof value {
    GreetingRequest greeting = 1;
    LocalUserRequest local_user = 2;
  }
}

message GreetingRequest {
  string verb = 1;
  string name = 2;
}
message GreetingResponse { string text = 1; }

message LocalUserRequest { string user_id = 1; }
message LocalUserResponse { optional User user = 1; }

//
// async

message AsyncRequest {
  oneof value {
    TopicListRequest topic_list = 1;
    TopicDetailsRequest topic_details = 2;
    SubforumFilterRequest subforum_filter = 3;
    ForumListRequest forum_list = 4;
    SleepRequest sleep = 1001;
  }
}

message SleepRequest { uint64 millis = 1; }
message SleepResponse { string text = 1; }

message TopicListRequest {
  string forum_id = 1;
  uint32 page = 2;
}
message TopicListResponse {
  Forum forum = 4;
  repeated Topic topics = 1;
  uint32 pages = 2;
  repeated Subforum subforums = 3;
}

message TopicDetailsRequest {
  string topic_id = 1;
  uint32 page = 2;
}
message TopicDetailsResponse {
  Topic topic = 1;
  repeated Reply replies = 2;
  uint32 pages = 3;
}

message SubforumFilterRequest {
  enum Operation {
    SHOW = 0;
    BLOCK = 1;
  }
  Operation operation = 1;
  string forum_id = 2;
  string subforum_filter_id = 3;
}
message SubforumFilterResponse {}

message ForumListRequest {}
message ForumListResponse { repeated Forum forums = 1; }
